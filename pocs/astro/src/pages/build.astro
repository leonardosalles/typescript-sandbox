---
import fs from "fs";
import path from "path";
import BuildInfo from "../components/BuildInfo.astro";

const distDir = path.resolve("./dist");

let buildFiles = [];
try {
  buildFiles = fs.readdirSync(distDir);
} catch (e) {
  buildFiles = ["(Nenhum build encontrado â€” rode `npm run build`)"];
}
---

<html lang="pt-BR">
  <head>
    <title>ðŸ”§ Astro Build Internals</title>
  </head>
  <body class="p-6 font-sans bg-gray-50">
    <h1 class="text-2xl font-bold mb-4">Internal Build & Render</h1>

    <section class="mb-6 p-4 bg-white shadow rounded">
      <h2 class="text-xl font-semibold mb-2">Last generated files:</h2>
      <ul class="list-disc ml-6">
        {buildFiles.map((file) => <li>{file}</li>)}
      </ul>
      <p class="text-sm text-gray-500 mt-2">
        *This list comes from the <code>dist/</code> directory. If you want to see
        more details, run the <code>build-logger</code> plugin during the build.
      </p>
    </section>

    <section class="p-4 bg-white shadow rounded">
      <h2 class="text-xl font-semibold mb-2">Component info</h2>
      <p class="text-gray-600 mb-2">
        Below is the raw content of the <code>Counter.astro</code> component and
        its compiled version (.js).
      </p>

      <BuildInfo />
    </section>
  </body>
</html>
